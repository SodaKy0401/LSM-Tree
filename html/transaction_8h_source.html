<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/LSM/transaction.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_91daed42788fc127f8a810504485482a.html">LSM</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">transaction.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="transaction_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;../Utils/files.h&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;../WAL/wal.h&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;deque&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">   15</a></span>&#160;<span class="keyword">enum class</span> <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">IsolationLevel</a> {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119a7b5722b7d02a9d8ff3a8bdfcb7d278c3">READ_UNCOMMITTED</a>,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119a1671fb17b5ce9bd0af0cf47f3f4ea337">READ_COMMITTED</a>,</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119aa4b37efaa1a6b533614ed81660dbf912">REPEATABLE_READ</a>,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119aadfafde622c8622bb72e4ff73e295cdb">SERIALIZABLE</a></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;};</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">class </span><a class="code" href="classLSMEngine.html">LSMEngine</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">class </span><a class="code" href="classTranManager.html">TranManager</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classTranContext.html">   25</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTranContext.html">TranContext</a> {</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="classTranContext.html#ae58f01b4e22577e33eac188a65a8a57d">   26</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classTranManager.html">TranManager</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classTranContext.html#a592838e0d9a81c941a9521c78c684de3">TranContext</a>(uint64_t tranc_id, std::shared_ptr&lt;LSMEngine&gt; engine,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;              std::shared_ptr&lt;TranManager&gt; tranManager,</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;              <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">IsolationLevel</a> &amp;isolation_level);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranContext.html#a055cc401c2fe7447a12a5141924d5eab">put</a>(<span class="keyword">const</span> std::string &amp;key, <span class="keyword">const</span> std::string &amp;value);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranContext.html#a2b6dfe43864f130192b89238d13b8e33">remove</a>(<span class="keyword">const</span> std::string &amp;key);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  std::optional&lt;std::string&gt; <a class="code" href="classTranContext.html#a48976e7b8bd80a04e58631588b4cf184">get</a>(<span class="keyword">const</span> std::string &amp;key);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// ! test_fail = true 是测试中手动触发的崩溃</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTranContext.html#a28049964f8c9427972e80c5c5ccba9d9">commit</a>(<span class="keywordtype">bool</span> test_fail = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTranContext.html#a5deca71973e49a4d7fecb82040f4e259">abort</a>();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keyword">enum</span> <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">IsolationLevel</a> <a class="code" href="classTranContext.html#ade3a8ea867db0c91d32658578ec3d761">get_isolation_level</a>();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classTranContext.html#ab7f6693552d1512ae8e9855ee7800116">   42</a></span>&#160;  std::shared_ptr&lt;LSMEngine&gt; <a class="code" href="classTranContext.html#ab7f6693552d1512ae8e9855ee7800116">engine_</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classTranContext.html#a35c4703d9f6bc2453b898e61f71d5dff">   43</a></span>&#160;  std::shared_ptr&lt;TranManager&gt; <a class="code" href="classTranContext.html#a35c4703d9f6bc2453b898e61f71d5dff">tranManager_</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classTranContext.html#af4c1d732a740270be48234b007c9de4f">   44</a></span>&#160;  uint64_t <a class="code" href="classTranContext.html#af4c1d732a740270be48234b007c9de4f">tranc_id_</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classTranContext.html#adb603645d26a288ae98a72ed81f62f57">   45</a></span>&#160;  std::vector&lt;Record&gt; <a class="code" href="classTranContext.html#adb603645d26a288ae98a72ed81f62f57">operations</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classTranContext.html#a1777c3fad67dabb868372de1e8b07ea3">   46</a></span>&#160;  std::unordered_map&lt;std::string, std::string&gt; <a class="code" href="classTranContext.html#a1777c3fad67dabb868372de1e8b07ea3">temp_map_</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classTranContext.html#ab37b6501ed3dfd3e3fad802142749a7b">   47</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTranContext.html#ab37b6501ed3dfd3e3fad802142749a7b">isCommited</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classTranContext.html#ab70fa3953e9a42083e259700c9fefe58">   48</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTranContext.html#ab70fa3953e9a42083e259700c9fefe58">isAborted</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classTranContext.html#a46877195cb3398e68ae94dee4953c4ed">   49</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">IsolationLevel</a> <a class="code" href="classTranContext.html#a46877195cb3398e68ae94dee4953c4ed">isolation_level_</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  std::unordered_map&lt;std::string,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                     std::optional&lt;std::pair&lt;std::string, uint64_t&gt;&gt;&gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      read_map_;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  std::unordered_map&lt;std::string,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                     std::optional&lt;std::pair&lt;std::string, uint64_t&gt;&gt;&gt;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      rollback_map_;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;};</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classTranManager.html">   60</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTranManager.html">TranManager</a> : <span class="keyword">public</span> std::enable_shared_from_this&lt;TranManager&gt; {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classTranManager.html#a1e193a2b5b69a0b4998dd0d57072b15e">TranManager</a>(std::string data_dir);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classTranManager.html#ac9d7c16ed282c5f668b0a245ca1a7f9c">~TranManager</a>();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranManager.html#aded0acb7a18beebaba561d7f535b780f">init_new_wal</a>();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranManager.html#afba1af729bcbf668167b936d7d5d0103">set_engine</a>(std::shared_ptr&lt;LSMEngine&gt; engine);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  std::shared_ptr&lt;TranContext&gt; <a class="code" href="classTranManager.html#ac584b6ccd47e0ccc06e815c0ce6589be">new_tranc</a>(<span class="keyword">const</span> <a class="code" href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">IsolationLevel</a> &amp;isolation_level);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  uint64_t <a class="code" href="classTranManager.html#a7f7d8fb69fc406748a60024fbc77febf">getNextTransactionId</a>();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  uint64_t <a class="code" href="classTranManager.html#afc9da778dbbecebb29b009de97a1687c">get_max_flushed_tranc_id</a>();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  uint64_t <a class="code" href="classTranManager.html#a85c163d7eacf23a7e149bcb735a4b718">get_max_finished_tranc_id_</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranManager.html#ad5dff3a2557df7fbca511bf0e1138014">update_max_finished_tranc_id</a>(uint64_t tranc_id);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranManager.html#a233fa9bb9fdd7fff5073f4a424fedc78">update_max_flushed_tranc_id</a>(uint64_t tranc_id);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTranManager.html#a899f239fad61e04d87a2a63a1cc92d12">write_to_wal</a>(<span class="keyword">const</span> std::vector&lt;Record&gt; &amp;records);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  std::map&lt;uint64_t, std::vector&lt;Record&gt;&gt; <a class="code" href="classTranManager.html#ace785fb46052f8c2c0fd652e135db8dd">check_recover</a>();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  std::string <a class="code" href="classTranManager.html#a09529ecb04b285e7870038e71542968d">get_tranc_id_file_path</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranManager.html#a9bb6705c6c2562a62b9c6c20930d86df">write_tranc_id_file</a>();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTranManager.html#aebb3f42efddbae3934aca039a4b01eb8">read_tranc_id_file</a>();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// void flusher();</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">mutable</span> std::mutex mutex_;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  std::shared_ptr&lt;LSMEngine&gt; engine_;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  std::shared_ptr&lt;WAL&gt; wal;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  std::string data_dir_;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// std::atomic&lt;bool&gt; flush_thread_running_ = true;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  std::atomic&lt;uint64_t&gt; nextTransactionId_ = 1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  std::atomic&lt;uint64_t&gt; max_flushed_tranc_id_ = 0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  std::atomic&lt;uint64_t&gt; max_finished_tranc_id_ = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  std::map&lt;uint64_t, std::shared_ptr&lt;TranContext&gt;&gt; activeTrans_;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classFileObj.html">FileObj</a> tranc_id_file_;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;};</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassFileObj_html_a69b0c26b261e14bd2f886e2e43ca70d5"><div class="ttname"><a href="classFileObj.html#a69b0c26b261e14bd2f886e2e43ca70d5">FileObj::open</a></div><div class="ttdeci">static FileObj open(const std::string &amp;path, bool create)</div><div class="ttdef"><b>Definition:</b> file.cpp:42</div></div>
<div class="ttc" id="aclassTranManager_html_afba1af729bcbf668167b936d7d5d0103"><div class="ttname"><a href="classTranManager.html#afba1af729bcbf668167b936d7d5d0103">TranManager::set_engine</a></div><div class="ttdeci">void set_engine(std::shared_ptr&lt; LSMEngine &gt; engine)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:265</div></div>
<div class="ttc" id="atransaction_8h_html"><div class="ttname"><a href="transaction_8h.html">transaction.h</a></div></div>
<div class="ttc" id="aclassTranContext_html_ab70fa3953e9a42083e259700c9fefe58"><div class="ttname"><a href="classTranContext.html#ab70fa3953e9a42083e259700c9fefe58">TranContext::isAborted</a></div><div class="ttdeci">bool isAborted</div><div class="ttdef"><b>Definition:</b> transaction.h:48</div></div>
<div class="ttc" id="aclassRecord_html_ae975e08b62be5966a28785b61f387bcb"><div class="ttname"><a href="classRecord.html#ae975e08b62be5966a28785b61f387bcb">Record::createRecord</a></div><div class="ttdeci">static Record createRecord(uint64_t tranc_id)</div><div class="ttdef"><b>Definition:</b> record.cpp:7</div></div>
<div class="ttc" id="aclassTranManager_html"><div class="ttname"><a href="classTranManager.html">TranManager</a></div><div class="ttdef"><b>Definition:</b> transaction.h:60</div></div>
<div class="ttc" id="aclassFileObj_html_a2bbd30a25cd765d3e94b7d5527f3c0a9"><div class="ttname"><a href="classFileObj.html#a2bbd30a25cd765d3e94b7d5527f3c0a9">FileObj::write</a></div><div class="ttdeci">bool write(size_t offset, std::vector&lt; uint8_t &gt; &amp;buf)</div><div class="ttdef"><b>Definition:</b> file.cpp:114</div></div>
<div class="ttc" id="aclassTranManager_html_a85c163d7eacf23a7e149bcb735a4b718"><div class="ttname"><a href="classTranManager.html#a85c163d7eacf23a7e149bcb735a4b718">TranManager::get_max_finished_tranc_id_</a></div><div class="ttdeci">uint64_t get_max_finished_tranc_id_()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:334</div></div>
<div class="ttc" id="aclassWAL_html_a25b00c97d5e13314180c6b7d2f69ea6e"><div class="ttname"><a href="classWAL.html#a25b00c97d5e13314180c6b7d2f69ea6e">WAL::recover</a></div><div class="ttdeci">static std::map&lt; uint64_t, std::vector&lt; Record &gt; &gt; recover(const std::string &amp;log_dir, uint64_t max_finished_tranc_id)</div><div class="ttdef"><b>Definition:</b> wal.cpp:38</div></div>
<div class="ttc" id="aclassTranContext_html_a48976e7b8bd80a04e58631588b4cf184"><div class="ttname"><a href="classTranContext.html#a48976e7b8bd80a04e58631588b4cf184">TranContext::get</a></div><div class="ttdeci">std::optional&lt; std::string &gt; get(const std::string &amp;key)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:68</div></div>
<div class="ttc" id="atransaction_8h_html_af3fd7ab4111446c2fe0882d0d45eb119a1671fb17b5ce9bd0af0cf47f3f4ea337"><div class="ttname"><a href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119a1671fb17b5ce9bd0af0cf47f3f4ea337">IsolationLevel::READ_COMMITTED</a></div><div class="ttdeci">@ READ_COMMITTED</div></div>
<div class="ttc" id="aclassTranManager_html_ac9d7c16ed282c5f668b0a245ca1a7f9c"><div class="ttname"><a href="classTranManager.html#ac9d7c16ed282c5f668b0a245ca1a7f9c">TranManager::~TranManager</a></div><div class="ttdeci">~TranManager()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:269</div></div>
<div class="ttc" id="aclassTranContext_html_a35c4703d9f6bc2453b898e61f71d5dff"><div class="ttname"><a href="classTranContext.html#a35c4703d9f6bc2453b898e61f71d5dff">TranContext::tranManager_</a></div><div class="ttdeci">std::shared_ptr&lt; TranManager &gt; tranManager_</div><div class="ttdef"><b>Definition:</b> transaction.h:43</div></div>
<div class="ttc" id="aclassTranContext_html_ab7f6693552d1512ae8e9855ee7800116"><div class="ttname"><a href="classTranContext.html#ab7f6693552d1512ae8e9855ee7800116">TranContext::engine_</a></div><div class="ttdeci">std::shared_ptr&lt; LSMEngine &gt; engine_</div><div class="ttdef"><b>Definition:</b> transaction.h:42</div></div>
<div class="ttc" id="aclassTranManager_html_ac584b6ccd47e0ccc06e815c0ce6589be"><div class="ttname"><a href="classTranManager.html#ac584b6ccd47e0ccc06e815c0ce6589be">TranManager::new_tranc</a></div><div class="ttdeci">std::shared_ptr&lt; TranContext &gt; new_tranc(const IsolationLevel &amp;isolation_level)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:339</div></div>
<div class="ttc" id="aclassTranContext_html"><div class="ttname"><a href="classTranContext.html">TranContext</a></div><div class="ttdef"><b>Definition:</b> transaction.h:25</div></div>
<div class="ttc" id="aclassTranManager_html_a899f239fad61e04d87a2a63a1cc92d12"><div class="ttname"><a href="classTranManager.html#a899f239fad61e04d87a2a63a1cc92d12">TranManager::write_to_wal</a></div><div class="ttdeci">bool write_to_wal(const std::vector&lt; Record &gt; &amp;records)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:361</div></div>
<div class="ttc" id="aclassTranManager_html_aebb3f42efddbae3934aca039a4b01eb8"><div class="ttname"><a href="classTranManager.html#aebb3f42efddbae3934aca039a4b01eb8">TranManager::read_tranc_id_file</a></div><div class="ttdeci">void read_tranc_id_file()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:292</div></div>
<div class="ttc" id="aclassFileObj_html_ab415bf419d8dcd74e59f9f0ce2d5afc8"><div class="ttname"><a href="classFileObj.html#ab415bf419d8dcd74e59f9f0ce2d5afc8">FileObj::sync</a></div><div class="ttdeci">bool sync()</div><div class="ttdef"><b>Definition:</b> file.cpp:134</div></div>
<div class="ttc" id="aclassTranContext_html_ab37b6501ed3dfd3e3fad802142749a7b"><div class="ttname"><a href="classTranContext.html#ab37b6501ed3dfd3e3fad802142749a7b">TranContext::isCommited</a></div><div class="ttdeci">bool isCommited</div><div class="ttdef"><b>Definition:</b> transaction.h:47</div></div>
<div class="ttc" id="aclassRecord_html_a409d3ad6ad58d0ad42dd87a7f41045cd"><div class="ttname"><a href="classRecord.html#a409d3ad6ad58d0ad42dd87a7f41045cd">Record::commitRecord</a></div><div class="ttdeci">static Record commitRecord(uint64_t tranc_id)</div><div class="ttdef"><b>Definition:</b> record.cpp:14</div></div>
<div class="ttc" id="atransaction_8h_html_af3fd7ab4111446c2fe0882d0d45eb119aadfafde622c8622bb72e4ff73e295cdb"><div class="ttname"><a href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119aadfafde622c8622bb72e4ff73e295cdb">IsolationLevel::SERIALIZABLE</a></div><div class="ttdeci">@ SERIALIZABLE</div></div>
<div class="ttc" id="aclassTranContext_html_a28049964f8c9427972e80c5c5ccba9d9"><div class="ttname"><a href="classTranContext.html#a28049964f8c9427972e80c5c5ccba9d9">TranContext::commit</a></div><div class="ttdeci">bool commit(bool test_fail=false)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:104</div></div>
<div class="ttc" id="aclassTranManager_html_a233fa9bb9fdd7fff5073f4a424fedc78"><div class="ttname"><a href="classTranManager.html#a233fa9bb9fdd7fff5073f4a424fedc78">TranManager::update_max_flushed_tranc_id</a></div><div class="ttdeci">void update_max_flushed_tranc_id(uint64_t tranc_id)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:312</div></div>
<div class="ttc" id="aclassTranManager_html_aded0acb7a18beebaba561d7f535b780f"><div class="ttname"><a href="classTranManager.html#aded0acb7a18beebaba561d7f535b780f">TranManager::init_new_wal</a></div><div class="ttdeci">void init_new_wal()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:254</div></div>
<div class="ttc" id="aclassTranContext_html_a2b6dfe43864f130192b89238d13b8e33"><div class="ttname"><a href="classTranContext.html#a2b6dfe43864f130192b89238d13b8e33">TranContext::remove</a></div><div class="ttdeci">void remove(const std::string &amp;key)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:49</div></div>
<div class="ttc" id="aclassTranContext_html_ade3a8ea867db0c91d32658578ec3d761"><div class="ttname"><a href="classTranContext.html#ade3a8ea867db0c91d32658578ec3d761">TranContext::get_isolation_level</a></div><div class="ttdeci">enum IsolationLevel get_isolation_level()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:235</div></div>
<div class="ttc" id="aclassLSMEngine_html"><div class="ttname"><a href="classLSMEngine.html">LSMEngine</a></div><div class="ttdef"><b>Definition:</b> engine.h:29</div></div>
<div class="ttc" id="aclassTranContext_html_a592838e0d9a81c941a9521c78c684de3"><div class="ttname"><a href="classTranContext.html#a592838e0d9a81c941a9521c78c684de3">TranContext::TranContext</a></div><div class="ttdeci">TranContext(uint64_t tranc_id, std::shared_ptr&lt; LSMEngine &gt; engine, std::shared_ptr&lt; TranManager &gt; tranManager, const enum IsolationLevel &amp;isolation_level)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:22</div></div>
<div class="ttc" id="aclassTranContext_html_a055cc401c2fe7447a12a5141924d5eab"><div class="ttname"><a href="classTranContext.html#a055cc401c2fe7447a12a5141924d5eab">TranContext::put</a></div><div class="ttdeci">void put(const std::string &amp;key, const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:30</div></div>
<div class="ttc" id="atransaction_8h_html_af3fd7ab4111446c2fe0882d0d45eb119aa4b37efaa1a6b533614ed81660dbf912"><div class="ttname"><a href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119aa4b37efaa1a6b533614ed81660dbf912">IsolationLevel::REPEATABLE_READ</a></div><div class="ttdeci">@ REPEATABLE_READ</div></div>
<div class="ttc" id="aclassRecord_html_af2e51872fa9210fe80b1273a9f6d5ad8"><div class="ttname"><a href="classRecord.html#af2e51872fa9210fe80b1273a9f6d5ad8">Record::deleteRecord</a></div><div class="ttdeci">static Record deleteRecord(uint64_t tranc_id, const std::string &amp;key)</div><div class="ttdef"><b>Definition:</b> record.cpp:40</div></div>
<div class="ttc" id="atransaction_8h_html_af3fd7ab4111446c2fe0882d0d45eb119a7b5722b7d02a9d8ff3a8bdfcb7d278c3"><div class="ttname"><a href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119a7b5722b7d02a9d8ff3a8bdfcb7d278c3">IsolationLevel::READ_UNCOMMITTED</a></div><div class="ttdeci">@ READ_UNCOMMITTED</div></div>
<div class="ttc" id="aclassTranManager_html_a1e193a2b5b69a0b4998dd0d57072b15e"><div class="ttname"><a href="classTranManager.html#a1e193a2b5b69a0b4998dd0d57072b15e">TranManager::TranManager</a></div><div class="ttdeci">TranManager(std::string data_dir)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:241</div></div>
<div class="ttc" id="aclassTranContext_html_af4c1d732a740270be48234b007c9de4f"><div class="ttname"><a href="classTranContext.html#af4c1d732a740270be48234b007c9de4f">TranContext::tranc_id_</a></div><div class="ttdeci">uint64_t tranc_id_</div><div class="ttdef"><b>Definition:</b> transaction.h:44</div></div>
<div class="ttc" id="aclassFileObj_html_a0561edf88b7d241900861709673d2bdf"><div class="ttname"><a href="classFileObj.html#a0561edf88b7d241900861709673d2bdf">FileObj::read_uint64</a></div><div class="ttdeci">uint64_t read_uint64(size_t offset)</div><div class="ttdef"><b>Definition:</b> file.cpp:100</div></div>
<div class="ttc" id="atransaction_8h_html_af3fd7ab4111446c2fe0882d0d45eb119"><div class="ttname"><a href="transaction_8h.html#af3fd7ab4111446c2fe0882d0d45eb119">IsolationLevel</a></div><div class="ttdeci">IsolationLevel</div><div class="ttdef"><b>Definition:</b> transaction.h:15</div></div>
<div class="ttc" id="aclassMemTable_html"><div class="ttname"><a href="classMemTable.html">MemTable</a></div><div class="ttdef"><b>Definition:</b> memtable.h:26</div></div>
<div class="ttc" id="aclassTranContext_html_a5deca71973e49a4d7fecb82040f4e259"><div class="ttname"><a href="classTranContext.html#a5deca71973e49a4d7fecb82040f4e259">TranContext::abort</a></div><div class="ttdeci">bool abort()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:201</div></div>
<div class="ttc" id="aclassTranManager_html_afc9da778dbbecebb29b009de97a1687c"><div class="ttname"><a href="classTranManager.html#afc9da778dbbecebb29b009de97a1687c">TranManager::get_max_flushed_tranc_id</a></div><div class="ttdeci">uint64_t get_max_flushed_tranc_id()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:330</div></div>
<div class="ttc" id="aclassTranContext_html_a1777c3fad67dabb868372de1e8b07ea3"><div class="ttname"><a href="classTranContext.html#a1777c3fad67dabb868372de1e8b07ea3">TranContext::temp_map_</a></div><div class="ttdeci">std::unordered_map&lt; std::string, std::string &gt; temp_map_</div><div class="ttdef"><b>Definition:</b> transaction.h:46</div></div>
<div class="ttc" id="aclassTranContext_html_adb603645d26a288ae98a72ed81f62f57"><div class="ttname"><a href="classTranContext.html#adb603645d26a288ae98a72ed81f62f57">TranContext::operations</a></div><div class="ttdeci">std::vector&lt; Record &gt; operations</div><div class="ttdef"><b>Definition:</b> transaction.h:45</div></div>
<div class="ttc" id="aclassRecord_html_a2baae25665367bbb6868b5dee10a97e6"><div class="ttname"><a href="classRecord.html#a2baae25665367bbb6868b5dee10a97e6">Record::putRecord</a></div><div class="ttdeci">static Record putRecord(uint64_t tranc_id, const std::string &amp;key, const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> record.cpp:28</div></div>
<div class="ttc" id="aclassTranManager_html_a7f7d8fb69fc406748a60024fbc77febf"><div class="ttname"><a href="classTranManager.html#a7f7d8fb69fc406748a60024fbc77febf">TranManager::getNextTransactionId</a></div><div class="ttdeci">uint64_t getNextTransactionId()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:326</div></div>
<div class="ttc" id="aclassTranContext_html_a46877195cb3398e68ae94dee4953c4ed"><div class="ttname"><a href="classTranContext.html#a46877195cb3398e68ae94dee4953c4ed">TranContext::isolation_level_</a></div><div class="ttdeci">enum IsolationLevel isolation_level_</div><div class="ttdef"><b>Definition:</b> transaction.h:49</div></div>
<div class="ttc" id="aclassTranManager_html_a9bb6705c6c2562a62b9c6c20930d86df"><div class="ttname"><a href="classTranManager.html#a9bb6705c6c2562a62b9c6c20930d86df">TranManager::write_tranc_id_file</a></div><div class="ttdeci">void write_tranc_id_file()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:271</div></div>
<div class="ttc" id="aengine_8h_html"><div class="ttname"><a href="engine_8h.html">engine.h</a></div></div>
<div class="ttc" id="aclassTranManager_html_ad5dff3a2557df7fbca511bf0e1138014"><div class="ttname"><a href="classTranManager.html#ad5dff3a2557df7fbca511bf0e1138014">TranManager::update_max_finished_tranc_id</a></div><div class="ttdeci">void update_max_finished_tranc_id(uint64_t tranc_id)</div><div class="ttdef"><b>Definition:</b> transaction.cpp:298</div></div>
<div class="ttc" id="aclassTranManager_html_ace785fb46052f8c2c0fd652e135db8dd"><div class="ttname"><a href="classTranManager.html#ace785fb46052f8c2c0fd652e135db8dd">TranManager::check_recover</a></div><div class="ttdeci">std::map&lt; uint64_t, std::vector&lt; Record &gt; &gt; check_recover()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:355</div></div>
<div class="ttc" id="aclassFileObj_html"><div class="ttname"><a href="classFileObj.html">FileObj</a></div><div class="ttdef"><b>Definition:</b> files.h:11</div></div>
<div class="ttc" id="aclassTranManager_html_a09529ecb04b285e7870038e71542968d"><div class="ttname"><a href="classTranManager.html#a09529ecb04b285e7870038e71542968d">TranManager::get_tranc_id_file_path</a></div><div class="ttdeci">std::string get_tranc_id_file_path()</div><div class="ttdef"><b>Definition:</b> transaction.cpp:348</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
